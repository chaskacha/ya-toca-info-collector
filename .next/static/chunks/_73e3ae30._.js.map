{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaskacha/Desktop/projects/ya_toca/ya_toca_backup_info_collector/src/components/basic/action-button/page.tsx"],"sourcesContent":["'use client';\nimport { Result } from '@/lib/types';\nimport React, { useState } from 'react';\n\ntype Props = {\n    label: string;\n    onAction: () => Promise<Result | void>; // return a Result or nothing (defaults to success)\n    className?: string;\n    style?: React.CSSProperties;\n    disabled?: boolean;\n    height?: number;          // default 48\n    autoHideMs?: number;      // default 4000\n};\n\nexport default function ActionButton({\n    label,\n    onAction,\n    className = '',\n    style,\n    disabled,\n    height = 48,\n    autoHideMs = 4000,\n}: Props) {\n    const [busy, setBusy] = useState(false);\n    const [msg, setMsg] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n\n    const handleClick = async () => {\n        if (busy || disabled) return;\n        setBusy(true);\n        try {\n            const res = await onAction();\n            const r = (res as Result) ?? { status: 'success', message: 'Listo.' };\n            setMsg({ type: r.status, text: r.message });\n        } catch (err: any) {\n            setMsg({ type: 'error', text: err?.message || 'Ocurri√≥ un error.' });\n        } finally {\n            setTimeout(() => {\n                setBusy(false);\n                if (autoHideMs) setTimeout(() => setMsg(null), autoHideMs);\n            }, 2000);\n        }\n    };\n\n    return (\n        <div className=\"mb24\">\n            <button\n                className={`btn w100 fw700 fs16 uppercase ${className}`}\n                style={{ height, ...style }}\n                onClick={handleClick}\n                disabled={disabled || busy}\n            >\n                {busy ? 'Enviando...' : label}\n            </button>\n\n            {msg && (\n                <div\n                    className={`notice ${msg.type}`}\n                    role=\"status\"\n                    aria-live=\"polite\"\n                    style={{ marginTop: 8 }}\n                >\n                    {msg.text}\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;AAEA;;;AAFA;;AAce,SAAS,aAAa,EACjC,KAAK,EACL,QAAQ,EACR,YAAY,EAAE,EACd,KAAK,EACL,QAAQ,EACR,SAAS,EAAE,EACX,aAAa,IAAI,EACb;;IACJ,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAsD;IAEnF,MAAM,cAAc;QAChB,IAAI,QAAQ,UAAU;QACtB,QAAQ;QACR,IAAI;YACA,MAAM,MAAM,MAAM;YAClB,MAAM,IAAI,AAAC,OAAkB;gBAAE,QAAQ;gBAAW,SAAS;YAAS;YACpE,OAAO;gBAAE,MAAM,EAAE,MAAM;gBAAE,MAAM,EAAE,OAAO;YAAC;QAC7C,EAAE,OAAO,KAAU;YACf,OAAO;gBAAE,MAAM;gBAAS,MAAM,KAAK,WAAW;YAAoB;QACtE,SAAU;YACN,WAAW;gBACP,QAAQ;gBACR,IAAI,YAAY,WAAW,IAAM,OAAO,OAAO;YACnD,GAAG;QACP;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBACG,WAAW,CAAC,8BAA8B,EAAE,WAAW;gBACvD,OAAO;oBAAE;oBAAQ,GAAG,KAAK;gBAAC;gBAC1B,SAAS;gBACT,UAAU,YAAY;0BAErB,OAAO,gBAAgB;;;;;;YAG3B,qBACG,6LAAC;gBACG,WAAW,CAAC,OAAO,EAAE,IAAI,IAAI,EAAE;gBAC/B,MAAK;gBACL,aAAU;gBACV,OAAO;oBAAE,WAAW;gBAAE;0BAErB,IAAI,IAAI;;;;;;;;;;;;AAK7B;GApDwB;KAAA","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaskacha/Desktop/projects/ya_toca/ya_toca_backup_info_collector/src/components/Composer.tsx"],"sourcesContent":["'use client';\nimport React, { useRef, useState } from 'react';\nimport type { MessagePayload, Result, UploadAudio, UploadImage } from '@/lib/types';\nimport ActionButton from './basic/action-button/page';\nimport { useRouter } from 'next/navigation';\n\nfunction markStationDone(n: number) {\n    const raw = localStorage.getItem('yt_stations_done') || '[]';\n    const arr = Array.isArray(JSON.parse(raw)) ? JSON.parse(raw) : [];\n    const set = new Set<number>(arr);\n    set.add(n);\n    localStorage.setItem('yt_stations_done', JSON.stringify(Array.from(set).sort()));\n}\n\nasync function fileToDataUrl(file: File): Promise<string> {\n    return new Promise((res, rej) => {\n        const r = new FileReader();\n        r.onload = () => res(String(r.result));\n        r.onerror = rej;\n        r.readAsDataURL(file);\n    });\n}\n\nexport default function Composer({ kind, placeholder, num }: { kind: MessagePayload['type']; placeholder?: string; num: number }) {\n    const [text, setText] = useState('');\n    const [images, setImages] = useState<UploadImage[]>([]);\n    const [audio, setAudio] = useState<UploadAudio>(null);\n    const [busy, setBusy] = useState(false);\n    // Audio recorder\n    const mediaRecorder = useRef<MediaRecorder | null>(null);\n    const chunks = useRef<Blob[]>([]);\n    const [recording, setRecording] = useState(false);\n    const router = useRouter();\n\n    const startRec = async () => {\n        if (recording) return;\n        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n        const mr = new MediaRecorder(stream);\n        mediaRecorder.current = mr;\n        chunks.current = [];\n        mr.ondataavailable = (e) => { if (e.data.size) chunks.current.push(e.data); };\n        mr.onstop = async () => {\n            const blob = new Blob(chunks.current, { type: 'audio/webm' });\n            const dataUrl = await fileToDataUrl(new File([blob], 'audio.webm'));\n            setAudio({ mime: 'audio/webm', dataUrl });\n            stream.getTracks().forEach(t => t.stop());\n        };\n        mr.start();\n        setRecording(true);\n    };\n\n    const stopRec = () => { mediaRecorder.current?.stop(); setRecording(false); };\n\n\n    // const onPickImages = async (files: FileList | null) => {\n    //     if (!files) return;\n    //     const selected: UploadImage[] = [];\n    //     for (const f of Array.from(files).slice(0, 5)) {\n    //         const dataUrl = await fileToDataUrl(f);\n    //         selected.push({ filename: f.name, dataUrl });\n    //     }\n    //     setImages((prev) => [...prev, ...selected]);\n    // };\n\n    const submit = async (): Promise<Result> => {\n        setBusy(true);\n        try {\n            const payload: MessagePayload = { type: kind, text: text.trim() || undefined, images: images.length ? images : undefined, audio };\n            const res = await fetch('/api/messages', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });\n            const j = await res.json();\n            if (!res.ok) throw new Error(j.error || 'Error');\n            setText(''); setImages([]); setAudio(null);\n            return { status: 'success', message: '¬°Enviado correctamente!' };\n        } catch (e: any) {\n            return { status: 'error', message: e.message || 'Error' };\n        } finally { setBusy(false); markStationDone(num); router.replace('/'); }\n    };\n\n    return (\n        <div className=\"space-y-4\">\n            <textarea className=\"input w100\" placeholder={placeholder ?? 'Escribe aqu√≠‚Ä¶ (puedes usar emojis)'} value={text} onChange={(e) => setText(e.target.value)} />\n\n\n            {/* <div className=\"space-y-2\">\n                <label className=\"label\">Stickers/Im√°genes (hasta 5)</label>\n                <input type=\"file\" accept=\"image/*\" multiple onChange={(e) => onPickImages(e.target.files)} />\n                {images.length > 0 && (\n                    <div className=\"flex gap-2 flex-wrap\">\n                        {images.map((img, i) => (\n                            <img key={i} src={img.dataUrl} alt=\"preview\" className=\"w-16 h-16 rounded-lg object-cover border\" />\n                        ))}\n                    </div>\n                )}\n            </div> */}\n            <div className=\"space-y-2\">\n                <label className=\"label mr8\">Audio</label>\n                {!recording ? (\n                    <button type=\"button\" className=\"btn\" onClick={startRec}>üéôÔ∏è Grabar</button>\n                ) : (\n                    <button type=\"button\" className=\"btn\" onClick={stopRec}>‚èπÔ∏è Terminar</button>\n                )}\n                {audio && <p className=\"help\">Audio listo para enviar ({audio.mime}).</p>}\n            </div>\n            <br />\n            <ActionButton\n                label=\"Enviar\"\n                onAction={submit}\n                disabled={busy}\n                height={48}\n            />\n            <br />\n        </div>\n    );\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaskacha/Desktop/projects/ya_toca/ya_toca_backup_info_collector/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}